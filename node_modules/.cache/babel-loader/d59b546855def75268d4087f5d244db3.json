{"ast":null,"code":"import _regeneratorRuntime from\"/home/julianallende/Desktop/proyecto_sapo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/julianallende/Desktop/proyecto_sapo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/julianallende/Desktop/proyecto_sapo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{loadStripe}from\"@stripe/stripe-js\";import{Elements,CardElement,useStripe,useElements}from\"@stripe/react-stripe-js\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var stripePromise=loadStripe(\"pk_test_51J5EPQFOiWwOoK1YSaHbByG1mDZJJtKtGiutqeKKTrAs6Vr4hN8r6fprQXNA1x7BoxU5dvXL9jNdwtqTxwGHbiXk00TTjPMNxL\");console.log(stripePromise);var CheckoutForm=function CheckoutForm(){var stripe=useStripe();var elements=useElements();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$stripe$createP,error,paymentMethod,id,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('FROM SUBMITTED');e.preventDefault();_context.next=4;return stripe.createPaymentMethod({type:\"card\",card:elements.getElement(CardElement)});case 4:_yield$stripe$createP=_context.sent;error=_yield$stripe$createP.error;paymentMethod=_yield$stripe$createP.paymentMethod;console.log(paymentMethod,'PAYMENT METHOD');console.log(error,'ERROR');setLoading(true);if(error){_context.next=26;break;}console.log(paymentMethod);id=paymentMethod.id;_context.prev=13;_context.next=16;return axios.post(\"/api/checkout/payment\",{id:id,amount:10000//cents\n});case 16:_yield$axios$post=_context.sent;data=_yield$axios$post.data;console.log(data);elements.getElement(CardElement).clear();_context.next=25;break;case 22:_context.prev=22;_context.t0=_context[\"catch\"](13);console.log(_context.t0);case 25:setLoading(false);case 26:case\"end\":return _context.stop();}}},_callee,null,[[13,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();console.log(!stripe||loading);return/*#__PURE__*/_jsxs(\"form\",{className:\"card card-body\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://www.corsair.com/medias/sys_master/images/images/h80/hdd/9029904465950/-CH-9109011-ES-Gallery-K70-RGB-MK2-01.png\",alt:\"Corsair Gaming Keyboard RGB\",className:\"img-fluid\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-center my-2\",children:\"Price: 100$\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(CardElement,{})}),/*#__PURE__*/_jsx(\"button\",{disabled:!stripe,className:\"btn btn-success\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-light\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Loading...\"})}):\"Buy\"})]});};var Checkout=function Checkout(){return/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,children:/*#__PURE__*/_jsx(\"div\",{className:\"container p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 offset-md-4 h-100\",children:/*#__PURE__*/_jsx(CheckoutForm,{})})})})});};export default Checkout;","map":{"version":3,"sources":["/home/julianallende/Desktop/proyecto_sapo/client/src/components/Cart/Checkout.js"],"names":["React","useState","loadStripe","Elements","CardElement","useStripe","useElements","axios","stripePromise","console","log","CheckoutForm","stripe","elements","loading","setLoading","handleSubmit","e","preventDefault","createPaymentMethod","type","card","getElement","error","paymentMethod","id","post","amount","data","clear","Checkout"],"mappings":"kfAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CAEA,OAASC,UAAT,KAA2B,mBAA3B,CACA,OACEC,QADF,CAEEC,WAFF,CAGEC,SAHF,CAIEC,WAJF,KAKO,yBALP,CAMA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFACA,GAAMC,CAAAA,aAAa,CAAGN,UAAU,CAAC,6GAAD,CAAhC,CAEAO,OAAO,CAACC,GAAR,CAAYF,aAAZ,EAEA,GAAMG,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB,GAAMC,CAAAA,MAAM,CAAGP,SAAS,EAAxB,CACA,GAAMQ,CAAAA,QAAQ,CAAGP,WAAW,EAA5B,CAFyB,cAIKL,QAAQ,CAAC,KAAD,CAJb,wCAIlBa,OAJkB,eAITC,UAJS,eAMzB,GAAMC,CAAAA,YAAY,0FAAG,iBAAOC,CAAP,0LACnBR,OAAO,CAACC,GAAR,CAAY,gBAAZ,EACAO,CAAC,CAACC,cAAF,GAFmB,sBAIoBN,CAAAA,MAAM,CAACO,mBAAP,CAA2B,CAChEC,IAAI,CAAE,MAD0D,CAEhEC,IAAI,CAAER,QAAQ,CAACS,UAAT,CAAoBlB,WAApB,CAF0D,CAA3B,CAJpB,4CAIXmB,KAJW,uBAIXA,KAJW,CAIJC,aAJI,uBAIJA,aAJI,CAQnBf,OAAO,CAACC,GAAR,CAAYc,aAAZ,CAA2B,gBAA3B,EACAf,OAAO,CAACC,GAAR,CAAYa,KAAZ,CAAmB,OAAnB,EACAR,UAAU,CAAC,IAAD,CAAV,CAVmB,GAYdQ,KAZc,0BAajBd,OAAO,CAACC,GAAR,CAAYc,aAAZ,EACQC,EAdS,CAcFD,aAdE,CAcTC,EAdS,yCAgBQlB,CAAAA,KAAK,CAACmB,IAAN,CACrB,uBADqB,CAErB,CACED,EAAE,CAAFA,EADF,CAEEE,MAAM,CAAE,KAAO;AAFjB,CAFqB,CAhBR,yCAgBPC,IAhBO,mBAgBPA,IAhBO,CAwBfnB,OAAO,CAACC,GAAR,CAAYkB,IAAZ,EAEAf,QAAQ,CAACS,UAAT,CAAoBlB,WAApB,EAAiCyB,KAAjC,GA1Be,kFA4BfpB,OAAO,CAACC,GAAR,cA5Be,QA8BjBK,UAAU,CAAC,KAAD,CAAV,CA9BiB,sEAAH,kBAAZC,CAAAA,YAAY,4CAAlB,CAkCAP,OAAO,CAACC,GAAR,CAAY,CAACE,MAAD,EAAWE,OAAvB,EAEA,mBACE,cAAM,SAAS,CAAC,gBAAhB,CAAiC,QAAQ,CAAEE,YAA3C,wBAEE,YACE,GAAG,CAAC,yHADN,CAEE,GAAG,CAAC,6BAFN,CAGE,SAAS,CAAC,WAHZ,EAFF,cAQE,WAAI,SAAS,CAAC,kBAAd,yBARF,cAWE,YAAK,SAAS,CAAC,YAAf,uBACE,KAAC,WAAD,IADF,EAXF,cAeE,eAAQ,QAAQ,CAAE,CAACJ,MAAnB,CAA2B,SAAS,CAAC,iBAArC,UACGE,OAAO,cACN,YAAK,SAAS,CAAC,2BAAf,CAA2C,IAAI,CAAC,QAAhD,uBACE,aAAM,SAAS,CAAC,SAAhB,wBADF,EADM,CAKN,KANJ,EAfF,GADF,CA2BD,CArED,CAuEA,GAAMgB,CAAAA,QAAQ,CAAE,QAAVA,CAAAA,QAAU,EAAM,CACpB,mBACE,KAAC,QAAD,EAAU,MAAM,CAAEtB,aAAlB,uBACE,YAAK,SAAS,CAAC,eAAf,uBACE,YAAK,SAAS,CAAC,WAAf,uBACE,YAAK,SAAS,CAAC,4BAAf,uBACE,KAAC,YAAD,IADF,EADF,EADF,EADF,EADF,CAWD,CAZD,CAcA,cAAesB,CAAAA,QAAf","sourcesContent":["import React, { useState } from \"react\";\n\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  CardElement,\n  useStripe,\n  useElements,\n} from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\nconst stripePromise = loadStripe(\"pk_test_51J5EPQFOiWwOoK1YSaHbByG1mDZJJtKtGiutqeKKTrAs6Vr4hN8r6fprQXNA1x7BoxU5dvXL9jNdwtqTxwGHbiXk00TTjPMNxL\");\n\nconsole.log(stripePromise)\n\nconst CheckoutForm = () => {\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const [loading, setLoading] = useState(false);\n\n  const handleSubmit = async (e) => {\n    console.log('FROM SUBMITTED')\n    e.preventDefault();\n\n    const { error, paymentMethod } = await stripe.createPaymentMethod({\n      type: \"card\",\n      card: elements.getElement(CardElement),\n    });\n    console.log(paymentMethod, 'PAYMENT METHOD')\n    console.log(error, 'ERROR')\n    setLoading(true);\n\n    if (!error) {\n      console.log(paymentMethod)\n      const { id } = paymentMethod;\n      try {\n        const { data } = await axios.post(\n          \"/api/checkout/payment\",\n          {\n            id,\n            amount: 10000, //cents\n          }\n\n        );\n        console.log(data);\n\n        elements.getElement(CardElement).clear();\n      } catch (error) {\n        console.log(error);\n      }\n      setLoading(false);\n    }\n  };\n\n  console.log(!stripe || loading);\n\n  return (\n    <form className=\"card card-body\" onSubmit={handleSubmit}>\n      {/* Product Information */}\n      <img\n        src=\"https://www.corsair.com/medias/sys_master/images/images/h80/hdd/9029904465950/-CH-9109011-ES-Gallery-K70-RGB-MK2-01.png\"\n        alt=\"Corsair Gaming Keyboard RGB\"\n        className=\"img-fluid\"\n      />\n\n      <h3 className=\"text-center my-2\">Price: 100$</h3>\n\n      {/* User Card Input */}\n      <div className=\"form-group\">\n        <CardElement />\n      </div>\n\n      <button disabled={!stripe} className=\"btn btn-success\">\n        {loading ? (\n          <div className=\"spinner-border text-light\" role=\"status\">\n            <span className=\"sr-only\">Loading...</span>\n          </div>\n        ) : (\n          \"Buy\"\n        )}\n      </button>\n    </form>\n  );\n};\n\nconst Checkout =() => {\n  return (\n    <Elements stripe={stripePromise}>\n      <div className=\"container p-4\">\n        <div className=\"row h-100\">\n          <div className=\"col-md-4 offset-md-4 h-100\">\n            <CheckoutForm />\n          </div>\n        </div>\n      </div>\n    </Elements>\n  );\n}\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}