{"ast":null,"code":"import _regeneratorRuntime from\"/home/julianallende/Desktop/proyecto_sapo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/julianallende/Desktop/proyecto_sapo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/julianallende/Desktop/proyecto_sapo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{useHistory,Link}from'react-router-dom';import axios from\"axios\";import\"./UserDashboard.scss\";import Navbar from'../components/Navbar/Navbar';import GuideTable from'../components/UserDashboard/GuideTable';import Footer from'../components/Footer/Footer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UserDashboard=function UserDashboard(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),loggedInUser=_useState2[0],setLoggedInUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userGuides=_useState4[0],setUserGuides=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),privateData=_useState8[0],setPrivateData=_useState8[1];var history=useHistory();//Get Fetch Guides Function\nvar loadUserGuides=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(currentUser){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"api/user/guides/\".concat(currentUser),{headers:{'Content-Type':'application/json'}}).then(function(response){return response.json();}).then(function(json){console.log('Success:',json);console.log(json.data);setUserGuides(json.data);}).catch(function(error){console.error('Error:',error);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function loadUserGuides(_x){return _ref.apply(this,arguments);};}();//Fetch Private Data\nvar fetchPrivateDate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var config,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"authToken\"))}};_context2.prev=1;_context2.next=4;return axios.get(\"/api/private\",config);case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;setPrivateData(data.data);_context2.next=15;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);localStorage.removeItem(\"authToken\");localStorage.removeItem(\"email\");localStorage.removeItem(\"username\");setError(\"You are not authorized please login\");case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function fetchPrivateDate(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchPrivateDate();var currentUser=localStorage.getItem('email');console.log('currentUser: ',currentUser);loadUserGuides(currentUser);setLoggedInUser(currentUser);},[]);var logoutHandler=function logoutHandler(){localStorage.removeItem('authToken');localStorage.removeItem('email');localStorage.removeItem('username');history.push('/signin');};return error?/*#__PURE__*/_jsx(\"span\",{className:\"error-message\",children:error}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-wrapper-userdashboard\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"heading-userdashboards\",children:\"Welcome to Quiken\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"account-name\",children:[\"Cuenta: \",loggedInUser]}),/*#__PURE__*/_jsx(GuideTable,{userGuides:userGuides}),/*#__PURE__*/_jsxs(\"div\",{className:\"div-row-wrapper\",children:[/*#__PURE__*/_jsx(Link,{to:\"/createguide\",children:/*#__PURE__*/_jsx(\"button\",{id:\"blue\",className:\"btn-contact-form\",children:\"Create Guide\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-contact-form \",onClick:logoutHandler,children:\"Logout\"})]}),/*#__PURE__*/_jsx(Footer,{})]})]});};export default UserDashboard;","map":{"version":3,"sources":["/home/julianallende/Desktop/proyecto_sapo/client/src/Pages/UserDashboard.js"],"names":["useState","useEffect","useHistory","Link","axios","Navbar","GuideTable","Footer","UserDashboard","loggedInUser","setLoggedInUser","userGuides","setUserGuides","error","setError","privateData","setPrivateData","history","loadUserGuides","currentUser","fetch","headers","then","response","json","console","log","data","catch","fetchPrivateDate","config","Authorization","localStorage","getItem","get","removeItem","logoutHandler","push"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useHistory, Link } from 'react-router-dom'\nimport axios from \"axios\";\nimport \"./UserDashboard.scss\"\nimport Navbar from '../components/Navbar/Navbar'\nimport GuideTable from '../components/UserDashboard/GuideTable'\nimport Footer from '../components/Footer/Footer'\n\nconst UserDashboard = () => {   \n\n  const [loggedInUser, setLoggedInUser] = useState('')\n  const [userGuides, setUserGuides] = useState([])\n  const [error, setError] = useState(\"\");\n  const [privateData, setPrivateData] = useState(\"\");\n  const history = useHistory();\n\n  //Get Fetch Guides Function\n  const loadUserGuides = async (currentUser) => {\n    await fetch(`api/user/guides/${currentUser}`, {\n      headers: {\n        'Content-Type': 'application/json',\n      }\n    })\n    .then(response => response.json())\n    .then(json => {\n      console.log('Success:', json);\n      console.log(json.data)\n      setUserGuides(json.data)\n    })\n    .catch((error) => {\n      console.error('Error:', error);\n    });\n  };\n\n  //Fetch Private Data\n  const fetchPrivateDate = async () => {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`,\n      },\n    };\n    try {\n      \n      //AQUI VAN LAS RUTAS DE LAS GUIAS\n      const { data } = await axios.get(\"/api/private\", config);\n      setPrivateData(data.data);\n\n\n\n    } catch (error) {\n      localStorage.removeItem(\"authToken\");\n      localStorage.removeItem(\"email\");\n      localStorage.removeItem(\"username\");\n      setError(\"You are not authorized please login\");\n    }\n\n  };\n\n\n  useEffect(() => {\n\n    fetchPrivateDate();\n    let currentUser = localStorage.getItem('email')\n    console.log('currentUser: ', currentUser)\n    loadUserGuides(currentUser);\n    setLoggedInUser(currentUser)\n  }, []);\n\n  const logoutHandler = () => {\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('email');\n      localStorage.removeItem('username');\n      \n\n      history.push('/signin')\n  }\n\n  return error ? (\n    <span className=\"error-message\">{error}</span>\n  ) : (\n    <>  \n        <Navbar/>\n            <div className=\"main-wrapper-userdashboard\">\n                <h2 className=\"heading-userdashboards\">Welcome to Quiken</h2>\n                <div className=\"account-name\">Cuenta: {loggedInUser}</div>\n              <GuideTable userGuides={userGuides}/>\n              <div className=\"div-row-wrapper\">\n                <Link to=\"/createguide\">\n                  <button id=\"blue\" className=\"btn-contact-form\">Create Guide</button>\n                </Link>\n                <button className=\"btn-contact-form \" onClick={logoutHandler}>Logout</button>\n              </div>\n             <Footer/>\n            </div>\n        \n    </>\n  );\n};\n\nexport default UserDashboard;"]},"metadata":{},"sourceType":"module"}