{"ast":null,"code":"'use strict';\n\nvar isArray = require('./helpers').isArray;\n\nfunction groupDecorations(line) {\n  var groups = [],\n      currentGroup = null;\n\n  for (var i = 0, l = line.inlines.length; i < l; i++) {\n    var inline = line.inlines[i];\n    var decoration = inline.decoration;\n\n    if (!decoration) {\n      currentGroup = null;\n      continue;\n    }\n\n    if (!isArray(decoration)) {\n      decoration = [decoration];\n    }\n\n    var color = inline.decorationColor || inline.color || 'black';\n    var style = inline.decorationStyle || 'solid';\n\n    for (var ii = 0, ll = decoration.length; ii < ll; ii++) {\n      var decorationItem = decoration[ii];\n\n      if (!currentGroup || decorationItem !== currentGroup.decoration || style !== currentGroup.decorationStyle || color !== currentGroup.decorationColor) {\n        currentGroup = {\n          line: line,\n          decoration: decorationItem,\n          decorationColor: color,\n          decorationStyle: style,\n          inlines: [inline]\n        };\n        groups.push(currentGroup);\n      } else {\n        currentGroup.inlines.push(inline);\n      }\n    }\n  }\n\n  return groups;\n}\n\nfunction drawDecoration(group, x, y, pdfKitDoc) {\n  function maxInline() {\n    var max = 0;\n\n    for (var i = 0, l = group.inlines.length; i < l; i++) {\n      var inline = group.inlines[i];\n      max = inline.fontSize > max ? i : max;\n    }\n\n    return group.inlines[max];\n  }\n\n  function width() {\n    var sum = 0;\n\n    for (var i = 0, l = group.inlines.length; i < l; i++) {\n      var justifyShift = group.inlines[i].justifyShift || 0;\n      sum += group.inlines[i].width + justifyShift;\n    }\n\n    return sum;\n  }\n\n  var firstInline = group.inlines[0],\n      biggerInline = maxInline(),\n      totalWidth = width(),\n      lineAscent = group.line.getAscenderHeight(),\n      ascent = biggerInline.font.ascender / 1000 * biggerInline.fontSize,\n      height = biggerInline.height,\n      descent = height - ascent;\n  var lw = 0.5 + Math.floor(Math.max(biggerInline.fontSize - 8, 0) / 2) * 0.12;\n\n  switch (group.decoration) {\n    case 'underline':\n      y += lineAscent + descent * 0.45;\n      break;\n\n    case 'overline':\n      y += lineAscent - ascent * 0.85;\n      break;\n\n    case 'lineThrough':\n      y += lineAscent - ascent * 0.25;\n      break;\n\n    default:\n      throw 'Unkown decoration : ' + group.decoration;\n  }\n\n  pdfKitDoc.save();\n\n  if (group.decorationStyle === 'double') {\n    var gap = Math.max(0.5, lw * 2);\n    pdfKitDoc.fillColor(group.decorationColor).rect(x + firstInline.x, y - lw / 2, totalWidth, lw / 2).fill().rect(x + firstInline.x, y + gap - lw / 2, totalWidth, lw / 2).fill();\n  } else if (group.decorationStyle === 'dashed') {\n    var nbDashes = Math.ceil(totalWidth / (3.96 + 2.84));\n    var rdx = x + firstInline.x;\n    pdfKitDoc.rect(rdx, y, totalWidth, lw).clip();\n    pdfKitDoc.fillColor(group.decorationColor);\n\n    for (var i = 0; i < nbDashes; i++) {\n      pdfKitDoc.rect(rdx, y - lw / 2, 3.96, lw).fill();\n      rdx += 3.96 + 2.84;\n    }\n  } else if (group.decorationStyle === 'dotted') {\n    var nbDots = Math.ceil(totalWidth / (lw * 3));\n    var rx = x + firstInline.x;\n    pdfKitDoc.rect(rx, y, totalWidth, lw).clip();\n    pdfKitDoc.fillColor(group.decorationColor);\n\n    for (var ii = 0; ii < nbDots; ii++) {\n      pdfKitDoc.rect(rx, y - lw / 2, lw, lw).fill();\n      rx += lw * 3;\n    }\n  } else if (group.decorationStyle === 'wavy') {\n    var sh = 0.7,\n        sv = 1;\n    var nbWaves = Math.ceil(totalWidth / (sh * 2)) + 1;\n    var rwx = x + firstInline.x - 1;\n    pdfKitDoc.rect(x + firstInline.x, y - sv, totalWidth, y + sv).clip();\n    pdfKitDoc.lineWidth(0.24);\n    pdfKitDoc.moveTo(rwx, y);\n\n    for (var iii = 0; iii < nbWaves; iii++) {\n      pdfKitDoc.bezierCurveTo(rwx + sh, y - sv, rwx + sh * 2, y - sv, rwx + sh * 3, y).bezierCurveTo(rwx + sh * 4, y + sv, rwx + sh * 5, y + sv, rwx + sh * 6, y);\n      rwx += sh * 6;\n    }\n\n    pdfKitDoc.stroke(group.decorationColor);\n  } else {\n    pdfKitDoc.fillColor(group.decorationColor).rect(x + firstInline.x, y - lw / 2, totalWidth, lw).fill();\n  }\n\n  pdfKitDoc.restore();\n}\n\nfunction drawDecorations(line, x, y, pdfKitDoc) {\n  var groups = groupDecorations(line);\n\n  for (var i = 0, l = groups.length; i < l; i++) {\n    drawDecoration(groups[i], x, y, pdfKitDoc);\n  }\n}\n\nfunction drawBackground(line, x, y, pdfKitDoc) {\n  var height = line.getHeight();\n\n  for (var i = 0, l = line.inlines.length; i < l; i++) {\n    var inline = line.inlines[i];\n\n    if (!inline.background) {\n      continue;\n    }\n\n    var justifyShift = inline.justifyShift || 0;\n    pdfKitDoc.fillColor(inline.background).rect(x + inline.x - justifyShift, y, inline.width + justifyShift, height).fill();\n  }\n}\n\nmodule.exports = {\n  drawBackground: drawBackground,\n  drawDecorations: drawDecorations\n};","map":{"version":3,"sources":["/home/julianallende/Desktop/proyecto_sapo/client/node_modules/pdfmake/src/textDecorator.js"],"names":["isArray","require","groupDecorations","line","groups","currentGroup","i","l","inlines","length","inline","decoration","color","decorationColor","style","decorationStyle","ii","ll","decorationItem","push","drawDecoration","group","x","y","pdfKitDoc","maxInline","max","fontSize","width","sum","justifyShift","firstInline","biggerInline","totalWidth","lineAscent","getAscenderHeight","ascent","font","ascender","height","descent","lw","Math","floor","save","gap","fillColor","rect","fill","nbDashes","ceil","rdx","clip","nbDots","rx","sh","sv","nbWaves","rwx","lineWidth","moveTo","iii","bezierCurveTo","stroke","restore","drawDecorations","drawBackground","getHeight","background","module","exports"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar isArray = require('./helpers').isArray;\r\n\r\nfunction groupDecorations(line) {\r\n\tvar groups = [], currentGroup = null;\r\n\tfor (var i = 0, l = line.inlines.length; i < l; i++) {\r\n\t\tvar inline = line.inlines[i];\r\n\t\tvar decoration = inline.decoration;\r\n\t\tif (!decoration) {\r\n\t\t\tcurrentGroup = null;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (!isArray(decoration)) {\r\n\t\t\tdecoration = [decoration];\r\n\t\t}\r\n\t\tvar color = inline.decorationColor || inline.color || 'black';\r\n\t\tvar style = inline.decorationStyle || 'solid';\r\n\t\tfor (var ii = 0, ll = decoration.length; ii < ll; ii++) {\r\n\t\t\tvar decorationItem = decoration[ii];\r\n\t\t\tif (!currentGroup || decorationItem !== currentGroup.decoration ||\r\n\t\t\t\tstyle !== currentGroup.decorationStyle || color !== currentGroup.decorationColor) {\r\n\r\n\t\t\t\tcurrentGroup = {\r\n\t\t\t\t\tline: line,\r\n\t\t\t\t\tdecoration: decorationItem,\r\n\t\t\t\t\tdecorationColor: color,\r\n\t\t\t\t\tdecorationStyle: style,\r\n\t\t\t\t\tinlines: [inline]\r\n\t\t\t\t};\r\n\t\t\t\tgroups.push(currentGroup);\r\n\t\t\t} else {\r\n\t\t\t\tcurrentGroup.inlines.push(inline);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn groups;\r\n}\r\n\r\nfunction drawDecoration(group, x, y, pdfKitDoc) {\r\n\tfunction maxInline() {\r\n\t\tvar max = 0;\r\n\t\tfor (var i = 0, l = group.inlines.length; i < l; i++) {\r\n\t\t\tvar inline = group.inlines[i];\r\n\t\t\tmax = inline.fontSize > max ? i : max;\r\n\t\t}\r\n\t\treturn group.inlines[max];\r\n\t}\r\n\tfunction width() {\r\n\t\tvar sum = 0;\r\n\t\tfor (var i = 0, l = group.inlines.length; i < l; i++) {\r\n\t\t\tvar justifyShift = (group.inlines[i].justifyShift || 0);\r\n\t\t\tsum += group.inlines[i].width + justifyShift;\r\n\t\t}\r\n\t\treturn sum;\r\n\t}\r\n\tvar firstInline = group.inlines[0],\r\n\t\tbiggerInline = maxInline(),\r\n\t\ttotalWidth = width(),\r\n\t\tlineAscent = group.line.getAscenderHeight(),\r\n\t\tascent = biggerInline.font.ascender / 1000 * biggerInline.fontSize,\r\n\t\theight = biggerInline.height,\r\n\t\tdescent = height - ascent;\r\n\r\n\tvar lw = 0.5 + Math.floor(Math.max(biggerInline.fontSize - 8, 0) / 2) * 0.12;\r\n\r\n\tswitch (group.decoration) {\r\n\t\tcase 'underline':\r\n\t\t\ty += lineAscent + descent * 0.45;\r\n\t\t\tbreak;\r\n\t\tcase 'overline':\r\n\t\t\ty += lineAscent - (ascent * 0.85);\r\n\t\t\tbreak;\r\n\t\tcase 'lineThrough':\r\n\t\t\ty += lineAscent - (ascent * 0.25);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tthrow 'Unkown decoration : ' + group.decoration;\r\n\t}\r\n\tpdfKitDoc.save();\r\n\r\n\tif (group.decorationStyle === 'double') {\r\n\t\tvar gap = Math.max(0.5, lw * 2);\r\n\t\tpdfKitDoc.fillColor(group.decorationColor)\r\n\t\t\t.rect(x + firstInline.x, y - lw / 2, totalWidth, lw / 2).fill()\r\n\t\t\t.rect(x + firstInline.x, y + gap - lw / 2, totalWidth, lw / 2).fill();\r\n\t} else if (group.decorationStyle === 'dashed') {\r\n\t\tvar nbDashes = Math.ceil(totalWidth / (3.96 + 2.84));\r\n\t\tvar rdx = x + firstInline.x;\r\n\t\tpdfKitDoc.rect(rdx, y, totalWidth, lw).clip();\r\n\t\tpdfKitDoc.fillColor(group.decorationColor);\r\n\t\tfor (var i = 0; i < nbDashes; i++) {\r\n\t\t\tpdfKitDoc.rect(rdx, y - lw / 2, 3.96, lw).fill();\r\n\t\t\trdx += 3.96 + 2.84;\r\n\t\t}\r\n\t} else if (group.decorationStyle === 'dotted') {\r\n\t\tvar nbDots = Math.ceil(totalWidth / (lw * 3));\r\n\t\tvar rx = x + firstInline.x;\r\n\t\tpdfKitDoc.rect(rx, y, totalWidth, lw).clip();\r\n\t\tpdfKitDoc.fillColor(group.decorationColor);\r\n\t\tfor (var ii = 0; ii < nbDots; ii++) {\r\n\t\t\tpdfKitDoc.rect(rx, y - lw / 2, lw, lw).fill();\r\n\t\t\trx += (lw * 3);\r\n\t\t}\r\n\t} else if (group.decorationStyle === 'wavy') {\r\n\t\tvar sh = 0.7, sv = 1;\r\n\t\tvar nbWaves = Math.ceil(totalWidth / (sh * 2)) + 1;\r\n\t\tvar rwx = x + firstInline.x - 1;\r\n\t\tpdfKitDoc.rect(x + firstInline.x, y - sv, totalWidth, y + sv).clip();\r\n\t\tpdfKitDoc.lineWidth(0.24);\r\n\t\tpdfKitDoc.moveTo(rwx, y);\r\n\t\tfor (var iii = 0; iii < nbWaves; iii++) {\r\n\t\t\tpdfKitDoc.bezierCurveTo(rwx + sh, y - sv, rwx + sh * 2, y - sv, rwx + sh * 3, y)\r\n\t\t\t\t.bezierCurveTo(rwx + sh * 4, y + sv, rwx + sh * 5, y + sv, rwx + sh * 6, y);\r\n\t\t\trwx += sh * 6;\r\n\t\t}\r\n\t\tpdfKitDoc.stroke(group.decorationColor);\r\n\t} else {\r\n\t\tpdfKitDoc.fillColor(group.decorationColor)\r\n\t\t\t.rect(x + firstInline.x, y - lw / 2, totalWidth, lw)\r\n\t\t\t.fill();\r\n\t}\r\n\tpdfKitDoc.restore();\r\n}\r\n\r\nfunction drawDecorations(line, x, y, pdfKitDoc) {\r\n\tvar groups = groupDecorations(line);\r\n\tfor (var i = 0, l = groups.length; i < l; i++) {\r\n\t\tdrawDecoration(groups[i], x, y, pdfKitDoc);\r\n\t}\r\n}\r\n\r\nfunction drawBackground(line, x, y, pdfKitDoc) {\r\n\tvar height = line.getHeight();\r\n\tfor (var i = 0, l = line.inlines.length; i < l; i++) {\r\n\t\tvar inline = line.inlines[i];\r\n\t\tif (!inline.background) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tvar justifyShift = (inline.justifyShift || 0);\r\n\t\tpdfKitDoc.fillColor(inline.background)\r\n\t\t\t.rect(x + inline.x - justifyShift, y, inline.width + justifyShift, height)\r\n\t\t\t.fill();\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tdrawBackground: drawBackground,\r\n\tdrawDecorations: drawDecorations\r\n};\r\n"]},"metadata":{},"sourceType":"script"}